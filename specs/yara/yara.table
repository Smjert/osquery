table_name("yara")
description("Track YARA matches for files or PIDs.")
schema([
    Column("path", TEXT, "The path scanned",
        additional=True, required=True),
    Column("matches", TEXT, "List of YARA matches"),
    Column("count", INTEGER, "Number of YARA matches"),
    Column("sig_group", TEXT, "Signature group used",
        additional=True),
    Column("sigfile", TEXT, "Signature file used",
        additional=True),
    Column("strings", TEXT, "Matching strings"),
    Column("tags", TEXT, "Matching tags"),
    Column("pid", TEXT, "Pid of the process to scan", additional=True, required=True),
])
implementation("yara@genYara")
examples([
  "select * from yara where path = '/etc/passwd'",
  "select * from yara where path LIKE '/etc/%'",
  "select * from yara where path = '/etc/passwd' and sigfile = '/etc/osquery/yara/test.yara'",
])
